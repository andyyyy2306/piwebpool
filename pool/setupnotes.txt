ATTENTION:
    - verifier que la commande depuis l'ecran principal commande bien les relais 0 / 1
    - il semblerais que tout soit ok (si c'est bien le cas), sauf pour l'appel direct de action.php?action=changeState ou il  y a une inversion
    - looks like the cronaction as well invert the command vs call.
    - il faut regarder dans action ou l'inversion se fait, pas dans la fonction bas niveau (function.php)
            - reprendre les js et css pour etre sur que les ?1:0 sont bons




install php5
install php5-mysql

install LUA
Packages to install (sudo apt-get install):
Install php5
Install php-pear
Install php5-dev
Install lua*.*   <---- (5.1)
Install liblua*.*


sudo ln -s /usr/include/lua*.*/ /usr/include/lua
Find liblua*.*.so and liblua*.*.a files in /usr/lib.
If they don't exist, they could be in /usr/lib/x86_64-linux-gnu or /usr/lib/i386-linux-gnu depending on OS.
Copy them from that directory into /usr/lib as liblua.so and liblua.a (WITHOUT VERSION NUMBER).
Example:
sudo cp /usr/lib/x86_64-linux-gnu/liblua5.2.a /usr/lib/liblua.a

FOR ME:
    apt-get install liblua5.1
    apt-get install liblua5.1-dev
    sudo ln -s /usr/include/lua5.1/* /usr/include/
    sudo cp /usr/lib/arm-linux-gnueabihf/liblua5.1.a /usr/lib/liblua.a
    sudo cp /usr/lib/arm-linux-gnueabihf/liblua5.1.so /usr/lib/liblua.so


Now execute the following command (1.1.0 is the version at the time of writing this):
sudo pecl install lua-1.1.0 ----> use the same
Add extension=lua.so to php.ini file (could be /etc/php5/(cli/apache)/php.ini)


//    sudo pecl install lua-1.1.0
wget https://pecl.php.net/get/lua-1.0.0.tgz
tar zxvf https://pecl.php.net/get/lua-1.0.0.tgz
cd lua-1.0.0
phpize
./configure --with-php-config=/usr/bin/php-config --with-lua=/usr/bin/lua
sudo make
sudo make install

vi /etc/php5/apache2/php.ini
find "Dynamic Extensions" and add extension=lua.so
/etc/init.d/apache2 restart

<?php
$lua = new Lua();
$lua->assign("php_var", array(1=>1, 2, 3)); //lua table index begin with 1
$lua->eval(<<<CODE
    print(php_var);
CODE
);
?>

//Operating System: Linux Solution: sendmail is searching for a FQDN ( fully qualified domain name ).
//To resolve this problem change /etc/hosts: FROM:
127.0.0.1       localhost
127.0.1.1       raspberrypi
TO:
127.0.0.1       localhost.localdomain piweb
127.0.1.1       piweb piweb.infrafast.com

edit /etc/hostname and change raspberrypi to piweb




OPTION 1 -------------------------------------------- NOT WOKRING, USE RELAY  INSTEAD , SEE NEXT
sudo apt-get install sendmail
configure php mail send
vi /etc/php5/apache2/php.ini
sendmail_path 	/usr/sbin/sendmail -t -i

OPTION 2 -------------------------------------------- NOT WOKRING, USE RELAY  INSTEAD , SEE NEXT


//allow apache to write to log.
touch logfile.txt
chmod a+w logfile.txt 


the application uses blockly from google scripts

change (/etc/apache2/site-enable/eniac or via webmin)
    from WSGIScriptAlias / /var/www/eniac/eniac/wsgi.py^
    to WSGIScriptAlias /eniac /var/www/eniac/eniac/wsgi.py^
    change port virtual host to 8080 for eniac
install piwire lib
create symlink /var/www/html/  ->pumpScheduler folder
install adafruit webide
install mysql-server --fix-missing
install phpmyadmin
create database pool
inject sql code into table via phpmyadmin
chmod 0775 stylesheet and javascripts to enable dynamc display
sudo apt-get install anacron
symlink ln -s /var/www/html/pumpScheduler/hourlycrontab.sh /etc/cron.hourly/pumpScheduler
sudo apt-get install php5-curl // used by netatmo


sudo usermod -a -G dialout www-data    // this is to access the ttyUSB0 from apache


DONE:   You have to change the following line of code in the PhpSerial.php class

FROM:

if ($this->_exec("stty") === 0) {
TO:

if ($this->_exec("stty --version") === 0) {


NOW SETUP THE STARTUP SCRIPT
vi /etc/rc.local
addline to initialize the USB pot (if not, then PHP function is not running)
    python /home/webide/repositories/my-pi-projects/pool/pumpScheduler/initUSB.py
