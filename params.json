{
  "name": "Piwebpool",
  "tagline": "The first full open source Raspberry PI PHP web-based application that automates the control of swiming pool",
  "body": "---------------------------------------------------------\r\n# WELCOME TO PIWEB SWIMMING POOL MANAGER v0.9\r\n---------------------------------------------------------\r\n\r\n![measures](https://github.com/infrafast/piwebpool/raw/gh-pages/wiki/measures.png)\r\n\r\nThe first full open source Raspberry PI PHP web-based application that automates the control of swiming pool with following features:\r\n\r\n    - real time water quality measurement (PH, ORP, Temperature)\r\n    - controls up to 4 power outlets\r\n    - history (graphs) of commands and measures\r\n    - weather forecast \r\n    - recommendation / advise on water treatment\r\n    - customizable notifications by email, sms or other channel throught standard API\r\n    - scheduler that control filtration aoccrding to water temperature\r\n    - can be controlled over your iPhone or any mobile device\r\n    - provide unlimited configuratio capabilities with a graphical scripting front end, no need to know programming\r\n    - notifications (SMS, email, or smartphone)\r\n\r\nInterfaces with :\r\n\r\n    - Domoticz and any other home automation system thru a simple HTTP API\r\n    - Any Smartphone applications\r\n\r\nSupported hardware:\r\n\r\n    - any ph,ORP and temperature probes should work\r\n    - the application is currently using the atlas-scientific EZO circuit with USB Isolation Carrier Board\r\n    - in case you want to interface with other circuit, all you have to do is adjusting getTemperature(), getORP() and getPh() in functions.php\r\n\r\nCabling:\r\n\r\n    by defaut (see configuration.php), GPIO pin:\r\n\t\t\t- pump relay=>11, you should cable the relay to replace your scheduler in the existing electric case\r\n\t\t\t- treatment relay=>16, \r\n\t\t    - second treatment relay=>12,\r\n\t\t    - power outlet (should be connected to a relay that command a contactor)=>15\r\n    probes: connect your probes with USB carrier as defined in USBDevices.id file\r\n        \r\nScripting:\r\n\r\n    two scripts are available:\r\n    \r\n        - main: this script is by defaut read only to avoid making unctronolled changes. You can check the box \"unlock\" and reload it using the webGUI if you want to modify it\r\n        - custom: this one is for the user and allow to experiment and create your own sequences        \r\n    \r\n---------------------------------------------------------\r\n# SETUP\r\n---------------------------------------------------------\r\nYou will find a script named setup.sh in the root directory, this script partially automates the installation of the application.\r\nSome manual steps are however required. You are advise to make the installation on a fresh raspberry dedicated to the application.\r\nOtherwise, have a look to the script before to make sure it doesn't break anything if you perform the setup on a productive raspberry \r\nalready used for other need. In case you have issues with dependencies and packages, please refer to the list later in this document\r\nso you can fix manually.\r\n\r\n\r\n** INSTALLATION **\r\n\r\n1) cd to your /var/www/html\r\n   sudo git clone git@bitbucket.org:infrafast/piwebpool.git\r\n   cd piwebpool\r\n\r\n2)  run the piwebpool install script using command \"source setup.sh\"\r\n    You can change default values in setup.sh file if you wish\r\n    Be careful, in particular the webroot is set to the piwebpool folder which could screw your existing install\r\n\r\n** CONFIGURATION **\r\n\r\nCheck and modify the configuration with your own setup:\r\n    \r\n    index.php                                           : locate loadWeather(\"46.203962, 6.133670\",0); and change it with your own coordinate\r\n    configuration                                       : change your db password, adjust GPIO mapping to your need if you wish \r\n    USBDevices.id                                       : map your sensors to the correct devices\r\n    scripts/hourlypiwebpool.sh                          : change INTERFACE=\"wlan0\" to your network interface\r\n                                                        : change path to piwebpool if necessary\r\n    functions.php                                       : getTemperature(), getORP() and getPh() to be adjusted if you don't use atlas scientific USB circuit\r\n    \r\n    /etc/rc.local                                       :make sure rc.local is updated (check the path to the application)\r\n    /etc/ssmtp/ssmtp.conf                               :edit your service provider info\r\n        root=postmaster\r\n        mailhub=yourproviderserver:587\r\n        hostname=piweb\r\n        AuthUser=youruseremail\r\n        AuthPass=yourpass\r\n        UseSTARTTLS=YES    \r\n        rewriteDomain=yourdomain\r\n        FromLineOverride=YES\r\n    /etc/ssmtp/revaliases                               :edit your service provider info\r\n        www-data:youruseremail:yourproviderserver:587\r\n    /etc/apache2/sites-available/000-default.conf       :make sure the documentroot point to piwebpool directory\r\n    /etc/php5/(cli+apache)/php.ini\r\n        Add extension=lua.so to php.ini file\r\n        find \"Dynamic Extensions\" and add extension=lua.so\r\n\r\n5) it is advised to reboot your rasp to check everything is ok or alternatively restart all services\r\n    e.g. sudo /etc/init.d/apache2 restart\r\n\r\n\r\nOptions:\r\n--------\r\n\r\nA) Make sure your raspberry config is ok\r\n    \r\n    sudo raspi-config\r\n         1-expand file system\r\n         5-locale fr UTF 8\r\n         5-timezone europe paris\r\n         5-keyboard layout\r\n             generic 105 - german french switzerland\r\n         9-advanced - sethostname: piweb3\r\n         9-advanced enable ssh\r\n    apt-get install rpi-update\r\n    rpi-update\r\n    \r\n\r\nB) setup wifi if not done (optionnal)\r\n\r\n    sudo vi /etc/wpa_supplicant/wpa_supplicant.conf\r\n        country=FR               \r\n        ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\r\n        update_config=1         \r\n        network={          \r\n           ssid=\"ASUS_AP\"   \r\n           psk=\"jt2p9ug1\"   \r\n        } \r\n\r\nC) install adafruit webide (optional) if you want to contribute         \r\n    ```\r\n    curl https://raw.githubusercontent.com/adafruit/Adafruit-WebIDE/alpha/scripts/install.sh | sudo sh\r\n    open http://your_raspberry_ip/config change port to 8090 as 80 is used by apache\r\n    sudo service adafruit-webide.sh restart\r\n    ```\r\n\r\nDependencies and third party tools (all pre-setup in the package):      \r\n\r\n    simpleweather.js            :weather forecast\r\n    loadingoverlay.js           :loading page animation\r\n    wiringpi                    :gpio commands\r\n    python-serial               :data acquisition via usb devices\r\n    php5-mysql,mysql-server:    :database and connectivity\r\n    apache2,php5                :webserver \r\n    php5-curl                   :interfacing other system via HTTP/Json API (like domoticz)\r\n    php5-gd                     :image png generation    \r\n    ssmtp                       :email notification\r\n    anacron                     :hourly execution of tasks (used by pump scheduler)\r\n    php-pear,php5dev,pecl       :compilation of lua for php\r\n    lua5.1,liblua5.1            :lua script execution engine (also include liblua5.1-dev which include the \"include\" necessary to compile)\r\n    phpserial.php               :patched with if ($this->_exec(\"stty\") === 0) { changed to if ($this->_exec(\"stty --version\") === 0) {\r\n    tablegear                   :dynamic modified and displayed tables\r\n    blockly                     :visual scripting\r\n    phpmygraph                  :measures and commands graphs\r\n    gdtext                      :text image drawing\r\n    jquery                      :webpage scripting\r\n    lua table persistence       :for persistent variable\r\n    Thanks for the work of idleman \r\n    \r\n---------------------------------------------------------\r\n# BUGS\r\n---------------------------------------------------------\r\n\r\nrefer to [github issues](https://github.com/infrafast/piwebpool/issues)\r\n\r\n---------------------------------------------------------\r\n# TODO LIST \r\n---------------------------------------------------------\r\n\r\nrefer to [github issues](https://github.com/infrafast/piwebpool/issues)\r\n\r\n-------------------------------------------------------------------\r\nGIT AND SSH KEY USAGE QUICK GUIDE\r\n-------------------------------------------------------------------\r\ngit status\r\ngit add -A .                 \r\ngit status\r\ngit commit -a -m \"comment\"   \r\ngit push origin master       \r\n\r\ngit tag -a v1.4 -m \"my version 1.4\"\r\ngit tag\r\ngit show v1.4\r\n\r\ngit push --follow-tags \r\ngit push --tags                    push all tags \r\n\r\n------------------------------------------------\r\n\r\nssh-keygen -t rsa -b 4096 -C \"info@infrafast.com\"  \r\neval \"$(ssh-agent -s)\"   \r\nssh-add ~/.ssh/id_rsa  \r\nmore ~/.ssh/id_rsa.pub -> copy in github  \r\ngit clone git@github.com:infrafast/piwebpool.git  ",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}